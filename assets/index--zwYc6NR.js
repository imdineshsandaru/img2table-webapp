(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))c(u);new MutationObserver(u=>{for(const p of u)if(p.type==="childList")for(const h of p.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function a(u){const p={};return u.integrity&&(p.integrity=u.integrity),u.referrerPolicy&&(p.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?p.credentials="include":u.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function c(u){if(u.ep)return;u.ep=!0;const p=a(u);fetch(u.href,p)}})();function Oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Te={exports:{}};(function(e){var r=function(a){var c=Object.prototype,u=c.hasOwnProperty,p=Object.defineProperty||function(n,t,o){n[t]=o.value},h,m=typeof Symbol=="function"?Symbol:{},v=m.iterator||"@@iterator",$=m.asyncIterator||"@@asyncIterator",R=m.toStringTag||"@@toStringTag";function g(n,t,o){return Object.defineProperty(n,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),n[t]}try{g({},"")}catch{g=function(t,o,i){return t[o]=i}}function w(n,t,o,i){var s=t&&t.prototype instanceof Y?t:Y,f=Object.create(s.prototype),E=new J(i||[]);return p(f,"_invoke",{value:ee(n,o,E)}),f}a.wrap=w;function _(n,t,o){try{return{type:"normal",arg:n.call(t,o)}}catch(i){return{type:"throw",arg:i}}}var M="suspendedStart",B="suspendedYield",P="executing",L="completed",y={};function Y(){}function U(){}function A(){}var z={};g(z,v,function(){return this});var K=Object.getPrototypeOf,F=K&&K(K(l([])));F&&F!==c&&u.call(F,v)&&(z=F);var I=A.prototype=Y.prototype=Object.create(z);U.prototype=A,p(I,"constructor",{value:A,configurable:!0}),p(A,"constructor",{value:U,configurable:!0}),U.displayName=g(A,R,"GeneratorFunction");function j(n){["next","throw","return"].forEach(function(t){g(n,t,function(o){return this._invoke(t,o)})})}a.isGeneratorFunction=function(n){var t=typeof n=="function"&&n.constructor;return t?t===U||(t.displayName||t.name)==="GeneratorFunction":!1},a.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,A):(n.__proto__=A,g(n,R,"GeneratorFunction")),n.prototype=Object.create(I),n},a.awrap=function(n){return{__await:n}};function W(n,t){function o(f,E,S,O){var b=_(n[f],n,E);if(b.type==="throw")O(b.arg);else{var re=b.arg,x=re.value;return x&&typeof x=="object"&&u.call(x,"__await")?t.resolve(x.__await).then(function(D){o("next",D,S,O)},function(D){o("throw",D,S,O)}):t.resolve(x).then(function(D){re.value=D,S(re)},function(D){return o("throw",D,S,O)})}}var i;function s(f,E){function S(){return new t(function(O,b){o(f,E,O,b)})}return i=i?i.then(S,S):S()}p(this,"_invoke",{value:s})}j(W.prototype),g(W.prototype,$,function(){return this}),a.AsyncIterator=W,a.async=function(n,t,o,i,s){s===void 0&&(s=Promise);var f=new W(w(n,t,o,i),s);return a.isGeneratorFunction(t)?f:f.next().then(function(E){return E.done?E.value:f.next()})};function ee(n,t,o){var i=M;return function(f,E){if(i===P)throw new Error("Generator is already running");if(i===L){if(f==="throw")throw E;return d()}for(o.method=f,o.arg=E;;){var S=o.delegate;if(S){var O=V(S,o);if(O){if(O===y)continue;return O}}if(o.method==="next")o.sent=o._sent=o.arg;else if(o.method==="throw"){if(i===M)throw i=L,o.arg;o.dispatchException(o.arg)}else o.method==="return"&&o.abrupt("return",o.arg);i=P;var b=_(n,t,o);if(b.type==="normal"){if(i=o.done?L:B,b.arg===y)continue;return{value:b.arg,done:o.done}}else b.type==="throw"&&(i=L,o.method="throw",o.arg=b.arg)}}}function V(n,t){var o=t.method,i=n.iterator[o];if(i===h)return t.delegate=null,o==="throw"&&n.iterator.return&&(t.method="return",t.arg=h,V(n,t),t.method==="throw")||o!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+o+"' method")),y;var s=_(i,n.iterator,t.arg);if(s.type==="throw")return t.method="throw",t.arg=s.arg,t.delegate=null,y;var f=s.arg;if(!f)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y;if(f.done)t[n.resultName]=f.value,t.next=n.nextLoc,t.method!=="return"&&(t.method="next",t.arg=h);else return f;return t.delegate=null,y}j(I),g(I,R,"Generator"),g(I,v,function(){return this}),g(I,"toString",function(){return"[object Generator]"});function te(n){var t={tryLoc:n[0]};1 in n&&(t.catchLoc=n[1]),2 in n&&(t.finallyLoc=n[2],t.afterLoc=n[3]),this.tryEntries.push(t)}function q(n){var t=n.completion||{};t.type="normal",delete t.arg,n.completion=t}function J(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(te,this),this.reset(!0)}a.keys=function(n){var t=Object(n),o=[];for(var i in t)o.push(i);return o.reverse(),function s(){for(;o.length;){var f=o.pop();if(f in t)return s.value=f,s.done=!1,s}return s.done=!0,s}};function l(n){if(n){var t=n[v];if(t)return t.call(n);if(typeof n.next=="function")return n;if(!isNaN(n.length)){var o=-1,i=function s(){for(;++o<n.length;)if(u.call(n,o))return s.value=n[o],s.done=!1,s;return s.value=h,s.done=!0,s};return i.next=i}}return{next:d}}a.values=l;function d(){return{value:h,done:!0}}return J.prototype={constructor:J,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(q),!n)for(var t in this)t.charAt(0)==="t"&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=h)},stop:function(){this.done=!0;var n=this.tryEntries[0],t=n.completion;if(t.type==="throw")throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function o(O,b){return f.type="throw",f.arg=n,t.next=O,b&&(t.method="next",t.arg=h),!!b}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],f=s.completion;if(s.tryLoc==="root")return o("end");if(s.tryLoc<=this.prev){var E=u.call(s,"catchLoc"),S=u.call(s,"finallyLoc");if(E&&S){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(E){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else if(S){if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(n,t){for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o];if(i.tryLoc<=this.prev&&u.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&(n==="break"||n==="continue")&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var f=s?s.completion:{};return f.type=n,f.arg=t,s?(this.method="next",this.next=s.finallyLoc,y):this.complete(f)},complete:function(n,t){if(n.type==="throw")throw n.arg;return n.type==="break"||n.type==="continue"?this.next=n.arg:n.type==="return"?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):n.type==="normal"&&t&&(this.next=t),y},finish:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===n)return this.complete(o.completion,o.afterLoc),q(o),y}},catch:function(n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===n){var i=o.completion;if(i.type==="throw"){var s=i.arg;q(o)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(n,t,o){return this.delegate={iterator:l(n),resultName:t,nextLoc:o},this.method==="next"&&(this.arg=h),y}},a}(e.exports);try{regeneratorRuntime=r}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}})(Te);var se=(e,r)=>`${e}-${r}-${Math.random().toString(16).slice(3,8)}`;const Re=se;let ce=0;var me=({id:e,action:r,payload:a={}})=>{let c=e;return typeof c>"u"&&(c=Re("Job",ce),ce+=1),{id:c,action:r,payload:a}},H={};let ie=!1;H.logging=ie;H.setLogging=e=>{ie=e};H.log=(...e)=>ie?console.log.apply(void 0,e):null;const ke=me,{log:Z}=H,_e=se;let le=0;var Ae=()=>{const e=_e("Scheduler",le),r={},a={};let c=[];le+=1;const u=()=>c.length,p=()=>Object.keys(r).length,h=()=>{if(c.length!==0){const g=Object.keys(r);for(let w=0;w<g.length;w+=1)if(typeof a[g[w]]>"u"){c[0](r[g[w]]);break}}},m=(g,w)=>new Promise((_,M)=>{const B=ke({action:g,payload:w});c.push(async P=>{c.shift(),a[P.id]=B;try{_(await P[g].apply(void 0,[...w,B.id]))}catch(L){M(L)}finally{delete a[P.id],h()}}),Z(`[${e}]: Add ${B.id} to JobQueue`),Z(`[${e}]: JobQueue length=${c.length}`),h()});return{addWorker:g=>(r[g.id]=g,Z(`[${e}]: Add ${g.id}`),Z(`[${e}]: Number of workers=${p()}`),h(),g.id),addJob:async(g,...w)=>{if(p()===0)throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return m(g,w)},terminate:async()=>{Object.keys(r).forEach(async g=>{await r[g].terminate()}),c=[]},getQueueLen:u,getNumWorkers:p}};function Ie(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Pe=e=>{const r={};return typeof WorkerGlobalScope<"u"?r.type="webworker":typeof document=="object"?r.type="browser":typeof process=="object"&&typeof Ie=="function"&&(r.type="node"),typeof e>"u"?r:r[e]};const Ce=Pe("type")==="browser",Ne=Ce?e=>new URL(e,window.location.href).href:e=>e;var $e=e=>{const r={...e};return["corePath","workerPath","langPath"].forEach(a=>{e[a]&&(r[a]=Ne(r[a]))}),r},ye={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const Me="6.0.1",Be={version:Me};var De={workerBlobURL:!0,logger:()=>{}};const Ge=Be.version,Ue=De;var Fe={...Ue,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Ge}/dist/worker.min.js`},je=({workerPath:e,workerBlobURL:r})=>{let a;if(Blob&&URL&&r){const c=new Blob([`importScripts("${e}");`],{type:"application/javascript"});a=new Worker(URL.createObjectURL(c))}else a=new Worker(e);return a},We=e=>{e.terminate()},He=(e,r)=>{e.onmessage=({data:a})=>{r(a)}},Ye=async(e,r)=>{e.postMessage(r)};const ne=e=>new Promise((r,a)=>{const c=new FileReader;c.onload=()=>{r(c.result)},c.onerror=({target:{error:{code:u}}})=>{a(Error(`File could not be read! Code=${u}`))},c.readAsArrayBuffer(e)}),ae=async e=>{let r=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?r=atob(e.split(",")[1]).split("").map(a=>a.charCodeAt(0)):r=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(r=await ae(e.src)),e.tagName==="VIDEO"&&(r=await ae(e.poster)),e.tagName==="CANVAS"&&await new Promise(a=>{e.toBlob(async c=>{r=await ne(c),a()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const a=await e.convertToBlob();r=await ne(a)}else(e instanceof File||e instanceof Blob)&&(r=await ne(e));return new Uint8Array(r)};var ze=ae;const Ke=Fe,qe=je,Je=We,xe=He,Xe=Ye,Ve=ze;var Ze={defaultOptions:Ke,spawnWorker:qe,terminateWorker:Je,onMessage:xe,send:Xe,loadImage:Ve};const Qe=$e,k=me,{log:ue}=H,et=se,G=ye,{defaultOptions:tt,spawnWorker:rt,terminateWorker:nt,onMessage:ot,loadImage:de,send:at}=Ze;let fe=0;var ve=async(e="eng",r=G.LSTM_ONLY,a={},c={})=>{const u=et("Worker",fe),{logger:p,errorHandler:h,...m}=Qe({...tt,...a}),v={},$=typeof e=="string"?e.split("+"):e;let R=r,g=c;const w=[G.DEFAULT,G.LSTM_ONLY].includes(r)&&!m.legacyCore;let _,M;const B=new Promise((l,d)=>{M=l,_=d}),P=l=>{_(l.message)};let L=rt(m);L.onerror=P,fe+=1;const y=({id:l,action:d,payload:n})=>new Promise((t,o)=>{ue(`[${u}]: Start ${l}, action=${d}`);const i=`${d}-${l}`;v[i]={resolve:t,reject:o},at(L,{workerId:u,jobId:l,action:d,payload:n})}),Y=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),U=l=>y(k({id:l,action:"load",payload:{options:{lstmOnly:w,corePath:m.corePath,logging:m.logging}}})),A=(l,d,n)=>y(k({id:n,action:"FS",payload:{method:"writeFile",args:[l,d]}})),z=(l,d)=>y(k({id:d,action:"FS",payload:{method:"readFile",args:[l,{encoding:"utf8"}]}})),K=(l,d)=>y(k({id:d,action:"FS",payload:{method:"unlink",args:[l]}})),F=(l,d,n)=>y(k({id:n,action:"FS",payload:{method:l,args:d}})),I=(l,d)=>y(k({id:d,action:"loadLanguage",payload:{langs:l,options:{langPath:m.langPath,dataPath:m.dataPath,cachePath:m.cachePath,cacheMethod:m.cacheMethod,gzip:m.gzip,lstmOnly:[G.DEFAULT,G.LSTM_ONLY].includes(R)&&!m.legacyLang}}})),j=(l,d,n,t)=>y(k({id:t,action:"initialize",payload:{langs:l,oem:d,config:n}})),W=(l="eng",d,n,t)=>{if(w&&[G.TESSERACT_ONLY,G.TESSERACT_LSTM_COMBINED].includes(d))throw Error("Legacy model requested but code missing.");const o=d||R;R=o;const i=n||g;g=i;const f=(typeof l=="string"?l.split("+"):l).filter(E=>!$.includes(E));return $.push(...f),f.length>0?I(f,t).then(()=>j(l,o,i,t)):j(l,o,i,t)},ee=(l={},d)=>y(k({id:d,action:"setParameters",payload:{params:l}})),V=async(l,d={},n={text:!0},t)=>y(k({id:t,action:"recognize",payload:{image:await de(l),options:d,output:n}})),te=async(l,d)=>{if(w)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return y(k({id:d,action:"detect",payload:{image:await de(l)}}))},q=async()=>(L!==null&&(nt(L),L=null),Promise.resolve());ot(L,({workerId:l,jobId:d,status:n,action:t,data:o})=>{const i=`${t}-${d}`;if(n==="resolve")ue(`[${l}]: Complete ${d}`),v[i].resolve({jobId:d,data:o}),delete v[i];else if(n==="reject")if(v[i].reject(o),delete v[i],t==="load"&&_(o),h)h(o);else throw Error(o);else n==="progress"&&p({...o,userJobId:d})});const J={id:u,worker:L,load:Y,writeText:A,readText:z,removeFile:K,FS:F,reinitialize:W,setParameters:ee,recognize:V,detect:te,terminate:q};return U().then(()=>I(e)).then(()=>j(e,r,c)).then(()=>M(J)).catch(()=>{}),B};const we=ve,st=async(e,r,a)=>{const c=await we(r,1,a);return c.recognize(e).finally(async()=>{await c.terminate()})},it=async(e,r)=>{const a=await we("osd",0,r);return a.detect(e).finally(async()=>{await a.terminate()})};var ct={recognize:st,detect:it},lt={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},ut={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const dt=Ae,ft=ve,ht=ct,pt=lt,gt=ye,mt=ut,{setLogging:yt}=H;var vt={languages:pt,OEM:gt,PSM:mt,createScheduler:dt,createWorker:ft,setLogging:yt,...ht};const wt=Oe(vt);async function Et(e){try{console.log("[OCR] Starting OCR process...");const r=await Lt(e);console.log("[OCR] Image loaded, starting recognition...");const{data:{text:a}}=await wt.recognize(r,"eng",{tessedit_char_whitelist:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789., ",preserve_interword_spaces:"1",tessedit_pageseg_mode:"6",tessedit_ocr_engine_mode:"3"});if(console.log("[OCR] Recognition complete. Extracted text:",a),!a||a.trim()==="")throw new Error("No text was detected in the image. Please try with a clearer image.");return a}catch(r){throw console.error("[OCR Error]",r),new Error("Error performing OCR: "+(r.message||"Unknown error"))}}function Lt(e){return new Promise((r,a)=>{const c=new FileReader;c.onload=()=>{console.log("[FileReader] File loaded successfully"),r(c.result)},c.onerror=()=>{console.error("[FileReader Error] Error reading file"),a(new Error("Error reading file"))},c.readAsDataURL(e)})}function St(e){try{const r=e.split(`
`).filter(h=>h.trim()!=="");if(r.length<2)throw new Error("Not enough data detected in the image.");const a=r[0].trim(),c=he(a);if(!c||c.length===0)throw new Error("Could not detect valid column headers.");const u=r.slice(1),p=[];for(const h of u){const m=he(h);if(m&&m.length===c.length){const v={};c.forEach(($,R)=>{v[$]=m[R]}),p.push(v)}}if(p.length===0)throw new Error("No valid data rows found in the image.");return{headers:c,rows:p}}catch(r){throw console.error("Parsing Error:",r),new Error("Error parsing table data: "+(r.message||"Invalid table format"))}}function he(e){let r;return r=e.trim().split(/\s{2,}/),r.length<2&&(r=e.trim().split(/\t+/)),r.length<2&&(r=e.match(/[^\s|]+/g)||[]),r.map(a=>a.trim())}function bt(e){try{return{headers:e.headers,rows:e.rows}}catch(r){throw console.error("Processing Error:",r),new Error("Error processing data: "+(r.message||"Unknown error"))}}function Ot(e){const{headers:r,rows:a}=e,c=document.getElementById("resultsTableBody"),u=document.querySelector("#resultsTable thead tr");c.innerHTML="",u.innerHTML="",r.forEach(p=>{const h=document.createElement("th");h.textContent=p,u.appendChild(h)}),a.forEach(p=>{const h=document.createElement("tr");r.forEach(m=>{const v=document.createElement("td");v.textContent=p[m],h.appendChild(v)}),c.appendChild(h)}),Tt()}function Tt(){document.querySelectorAll("#resultsTableBody tr").forEach((r,a)=>{r.style.opacity="0",r.style.transform="translateY(10px)",setTimeout(()=>{r.style.transition="opacity 300ms ease, transform 300ms ease",r.style.opacity="1",r.style.transform="translateY(0)"},50*a)})}function Rt(e){try{const r=XLSX.utils.book_new(),a=e.rows,c=XLSX.utils.json_to_sheet(a),u=e.headers.map(()=>({wch:15}));c["!cols"]=u,XLSX.utils.book_append_sheet(r,c,"Table Data"),XLSX.writeFile(r,"Table_Data.xlsx"),kt()}catch(r){console.error("Export Error:",r),alert("Error exporting to Excel: "+(r.message||"Unknown error"))}}function kt(){const e=document.getElementById("exportBtn"),r=e.innerHTML;e.innerHTML="Exported!",e.classList.add("btn-success"),setTimeout(()=>{e.innerHTML=r,e.classList.remove("btn-success")},2e3)}const Ee=document.getElementById("uploadSection"),Le=document.getElementById("processingSection"),Se=document.getElementById("resultsSection"),be=document.getElementById("errorSection"),T=document.getElementById("uploadContainer"),N=document.getElementById("fileInput"),oe=document.getElementById("processingStatus"),_t=document.getElementById("exportBtn"),At=document.getElementById("resetBtn"),It=document.getElementById("errorResetBtn"),Pt=document.getElementById("errorMessage");let X=null,C=!1;function Ct(){Nt()}function Nt(){N.addEventListener("change",async e=>{e.preventDefault();const r=e.target.files[0];r&&!C&&(r.type.startsWith("image/")?await pe(r):showError("Please upload an image file."))}),T.addEventListener("dragover",e=>{e.preventDefault(),e.stopPropagation(),C||T.classList.add("drag-over")}),T.addEventListener("dragleave",e=>{e.preventDefault(),e.stopPropagation(),T.classList.remove("drag-over")}),T.addEventListener("drop",async e=>{if(e.preventDefault(),e.stopPropagation(),T.classList.remove("drag-over"),!C&&e.dataTransfer.files.length>0){const r=e.dataTransfer.files[0];r.type.startsWith("image/")?await pe(r):showError("Please upload an image file.")}}),T.addEventListener("click",e=>{!C&&e.target===T&&(N.value="",N.click())}),_t.addEventListener("click",$t),At.addEventListener("click",ge),It.addEventListener("click",ge)}async function pe(e){if(!C)try{C=!0,N.disabled=!0,T.style.pointerEvents="none",Q(Le),oe.textContent="Performing OCR on the image...";const r=await Et(e);oe.textContent="Parsing extracted text...";const a=St(r);if(!a||a.length===0)throw new Error("Could not detect a proper table structure in the image. Please try with a clearer image.");oe.textContent="Calculating results...",X=bt(a),Ot(X),Q(Se)}catch(r){console.error("Error processing file:",r),Pt.textContent=r.message||"There was an error processing the image. Please try again with a clearer image.",Q(be)}finally{C=!1,N.disabled=!1,T.style.pointerEvents="auto",N.value=""}}function $t(){X&&Rt(X)}function ge(){N.value="",N.disabled=!1,T.style.pointerEvents="auto",X=null,C=!1,Q(Ee)}function Q(e){Ee.classList.add("hidden"),Le.classList.add("hidden"),Se.classList.add("hidden"),be.classList.add("hidden"),e.classList.remove("hidden"),e.classList.add("fade-in"),setTimeout(()=>{e.classList.remove("fade-in")},300)}document.addEventListener("DOMContentLoaded",Ct);
